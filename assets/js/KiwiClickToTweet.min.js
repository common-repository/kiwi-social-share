!function(){var e=function(e){for(var t="",n=0;n<23;n++)t+="o";return e.replace(/(http:\/\/[\S]*)/g,t).length};tinymce.PluginManager.add("KiwiClickToTweet",function(t,n){t.addButton("KiwiClickToTweet",{title:"Click to Tweet",icon:" kicon-twitter",onclick:function(){var n=this._id;t.windowManager.open({title:'Build "Click to Tweet"',class:"kiwi-click-to-tweet",body:[{type:"textbox",multiline:!0,style:"height:50px",name:"tweet",label:"The text that will be sent out on Twitter.",onkeyup:function(){var t=jQuery(".mce-first textarea").val(),a=(t.length,jQuery("#"+n).attr("data-handle"));if(t.indexOf("http")>-1||t.indexOf("https")>-1?linkSpace=0:linkSpace=23,void 0===a)var i=140-e(t)-linkSpace;else i=140-e(t)-linkSpace-a.length-6;i>1||0==i?jQuery(".tweetCounter").css({color:"green"}).text(i+" characters"):1==i?jQuery(".tweetCounter").css({color:"green"}).text(i+" character"):i<0&&jQuery(".tweetCounter").css({color:"red"}).text(i+" characters")},class:"tweetCounting"},{type:"label",name:"someHelpText",onPostRender:function(){var t=jQuery(".mce-first textarea").val(),a=(t.length,jQuery("#"+n).attr("data-handle"));if(t.indexOf("http")>-1||t.indexOf("https")>-1?linkSpace=0:linkSpace=23,void 0===a)var i=140-e(t)-linkSpace;else i=140-e(t)-linkSpace-a.length-6;this.getEl().innerHTML='<span style="float:right;">You have <span class="tweetCounter" style="color:green">'+i+" characters</span> remaining.</span>"},text:""},{type:"textbox",multiline:!0,style:"height:50px",name:"quote",label:"The quote as it will appear in your article."},{type:"label",name:"someHelpText2",onPostRender:function(){this.getEl().innerHTML='<div style="width:650px;">&nbsp;</div>'},text:""}],onsubmit:function(e){var n=117-jQuery(".mce-first textarea").val().length;return""===e.data.tweet||""===e.data.quote?(t.windowManager.alert("Please, fill in both fields."),!1):n<0?(t.windowManager.alert("You have too many characters in your tweet."),!1):void t.insertContent('[KiwiClickToTweet tweet="'+e.data.tweet.replace(/"/g,"'")+'" quote="'+e.data.quote.replace(/"/g,"'")+'"]')}})}})})}();